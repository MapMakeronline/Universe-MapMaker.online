# üó∫Ô∏è Universe MapMaker

Professional Mapbox-powered mapping application built with Next.js 15+, deployed on Google Cloud Run.

## üöÄ Live Demo

**Production**: [https://universe-mapmaker-vs4lfmh3ma-lm.a.run.app](https://universe-mapmaker-vs4lfmh3ma-lm.a.run.app)

## ‚ú® Features

- **Interactive Mapbox GL JS Map** - Smooth, responsive mapping experience
- **Real-time Coordinates** - Live position and zoom level display
- **Token Management** - Secure API-based token delivery for production
- **Mobile Optimized** - Touch-friendly controls and responsive design
- **Google Cloud Run** - Scalable, serverless deployment
- **Modern Stack** - Next.js 15+, React 19, TypeScript
- **User Authentication** - Complete auth system with registration, login, and profile management
- **Backend Integration** - Django REST API with PostgreSQL per-user databases

## üèóÔ∏è Architecture

### Project Structure Overview

```
Universe-MapMaker.online/
‚îÇ
‚îú‚îÄ‚îÄ üìÅ src/                      # ‚≠ê Main application code
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ components/          # React components
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ store/               # Redux state management
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ lib/                 # Helper utilities
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ types/               # TypeScript type definitions
‚îÇ
‚îú‚îÄ‚îÄ üìÅ app/                      # Next.js App Router
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                # Home page
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx              # Root layout
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ api/                 # API routes
‚îÇ
‚îú‚îÄ‚îÄ üìÅ public/                   # Static assets
‚îú‚îÄ‚îÄ üìÑ package.json             # Dependencies & scripts
‚îú‚îÄ‚îÄ üìÑ tsconfig.json            # TypeScript config
‚îú‚îÄ‚îÄ üìÑ cloudbuild.yaml          # Cloud Build config
‚îî‚îÄ‚îÄ üìÑ server.js                # Production server
```

### Detailed Structure Guide

#### üìÇ `src/components/` - UI Components

The heart of the application's user interface, organized by functionality:

```
src/components/
‚îÇ
‚îú‚îÄ‚îÄ üìÅ map/                          # üó∫Ô∏è Map Components
‚îÇ   ‚îú‚îÄ‚îÄ MapContainer.tsx            # Main Mapbox map container
‚îÇ   ‚îú‚îÄ‚îÄ DrawTools.tsx               # Drawing tools integration
‚îÇ   ‚îú‚îÄ‚îÄ Geocoder.tsx                # Address search functionality
‚îÇ   ‚îî‚îÄ‚îÄ MeasurementTools.tsx        # Distance/area measurement tools
‚îÇ
‚îú‚îÄ‚îÄ üìÅ panels/                       # üìä Side Panels
‚îÇ   ‚îú‚îÄ‚îÄ LeftPanel.tsx               # ‚≠ê Left panel with layer tree
‚îÇ   ‚îÇ                               #    - Drag & drop layers
‚îÇ   ‚îÇ                               #    - Layer properties panel
‚îÇ   ‚îÇ                               #    - Basemap selector
‚îÇ   ‚îÇ                               #    - Toolbar with actions
‚îÇ   ‚îú‚îÄ‚îÄ RightToolbar.tsx            # Right toolbar with tools
‚îÇ   ‚îú‚îÄ‚îÄ LayerTree.tsx               # Layer tree component
‚îÇ   ‚îú‚îÄ‚îÄ AddDatasetModal.tsx         # Add dataset dialog
‚îÇ   ‚îú‚îÄ‚îÄ AddLayerModal.tsx           # Add layer dialog
‚îÇ   ‚îú‚îÄ‚îÄ AddNationalLawModal.tsx     # National law data dialog
‚îÇ   ‚îú‚îÄ‚îÄ DrawingTools.tsx            # Drawing tools panel
‚îÇ   ‚îî‚îÄ‚îÄ MeasurementTools.tsx        # Measurement tools panel
‚îÇ
‚îú‚îÄ‚îÄ üìÅ drawing/                      # ‚úèÔ∏è Drawing Components
‚îÇ   ‚îî‚îÄ‚îÄ SimpleDrawingToolbar.tsx    # Simple drawing toolbar
‚îÇ
‚îú‚îÄ‚îÄ üìÅ measurement/                  # üìè Measurement Components
‚îÇ   ‚îî‚îÄ‚îÄ SimpleMeasurementToolbar.tsx # Simple measurement toolbar
‚îÇ
‚îî‚îÄ‚îÄ üìÅ providers/                    # üîå Context Providers
    ‚îî‚îÄ‚îÄ Providers.tsx                # Redux & Theme providers
```

**Key Components Explained:**

- **MapContainer.tsx**: Main map component handling Mapbox initialization, layer management, and map interactions
- **LeftPanel.tsx**: Most important UI component featuring hierarchical layer management with drag-and-drop, property editing, and basemap selection
- **RightToolbar.tsx**: Tool palette for drawing, measurements, fullscreen, and settings

#### üíæ `src/store/` - State Management

Redux-based state management for application-wide data:

```
src/store/
‚îÇ
‚îú‚îÄ‚îÄ store.ts                 # ‚öôÔ∏è Redux store configuration
‚îú‚îÄ‚îÄ hooks.ts                 # ü™ù Typed Redux hooks (useAppSelector, useAppDispatch)
‚îÇ
‚îî‚îÄ‚îÄ üìÅ slices/               # State slices (modular state)
    ‚îú‚îÄ‚îÄ mapSlice.ts         # Map state (zoom, center, style)
    ‚îú‚îÄ‚îÄ layersSlice.ts      # Layer management (list, visibility, properties)
    ‚îî‚îÄ‚îÄ drawSlice.ts        # Drawing state (geometries, active tool)
```

**How State Works:**

1. **Define state in slice:**
   ```typescript
   // layersSlice.ts
   const initialState = {
     layers: [],
     selectedLayer: null
   }
   ```

2. **Use in component:**
   ```typescript
   // LeftPanel.tsx
   const layers = useAppSelector(state => state.layers.layers)
   ```

3. **Update state:**
   ```typescript
   dispatch(addLayer({ id: '123', name: 'New Layer' }))
   ```

#### üõ†Ô∏è `src/lib/` - Utility Libraries

Helper functions and configurations:

```
src/lib/
‚îÇ
‚îú‚îÄ‚îÄ üìÅ mapbox/               # Mapbox configuration
‚îÇ   ‚îú‚îÄ‚îÄ config.ts           # API keys, default settings
‚îÇ   ‚îî‚îÄ‚îÄ draw-styles.ts      # Drawing styles configuration
‚îÇ
‚îú‚îÄ‚îÄ üìÅ turf/                 # Geospatial calculations
‚îÇ   ‚îî‚îÄ‚îÄ measurements.ts     # Distance/area calculations
‚îÇ
‚îî‚îÄ‚îÄ theme.ts                 # üé® Material-UI theme (colors, typography)
```

**Library Details:**

- **mapbox/config.ts**: Central configuration for Mapbox tokens, default center (Poland), zoom levels
- **turf/measurements.ts**: Geospatial calculations using Turf.js (length, area, distances)
- **theme.ts**: Application theme with color palette, supporting dark/light modes

#### üìù `src/types/` - TypeScript Definitions

Type definitions for type safety:

```
src/types/
‚îÇ
‚îú‚îÄ‚îÄ geometry.ts      # GeoJSON geometry types (Point, LineString, Polygon)
‚îú‚îÄ‚îÄ layers.ts        # Layer types (Layer, Group, LayerConfig)
‚îî‚îÄ‚îÄ map.ts           # Map types (MapConfig, ViewState)
```

**Example Type Definition:**
```typescript
// layers.ts
export interface Layer {
  id: string
  name: string
  visible: boolean
  type: 'vector' | 'raster' | 'group'
  children?: Layer[]
}
```

#### üö™ `app/` - Next.js App Router

File-based routing system:

```
app/
‚îÇ
‚îú‚îÄ‚îÄ page.tsx             # üè† Home page (/)
‚îú‚îÄ‚îÄ layout.tsx           # Root layout wrapper
‚îÇ
‚îú‚îÄ‚îÄ üìÅ map/              # Map page (/map)
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
‚îÇ
‚îî‚îÄ‚îÄ üìÅ api/              # üîå API Routes
    ‚îî‚îÄ‚îÄ mapbox/
        ‚îî‚îÄ‚îÄ status/
            ‚îî‚îÄ‚îÄ route.ts  # Health check endpoint
```

**Routing Convention:**
- `app/page.tsx` ‚Üí `/`
- `app/map/page.tsx` ‚Üí `/map`
- `app/api/mapbox/status/route.ts` ‚Üí `/api/mapbox/status`

### Key Technical Decisions

- **Runtime Token Loading**: API route serves Mapbox tokens at runtime instead of build-time
- **Direct Mapbox Integration**: No abstractions - direct mapbox-gl usage for maximum control
- **Redux Toolkit**: Modern Redux with TypeScript for predictable state management
- **Material-UI**: Comprehensive design system with theming support
- **Cloud Run Deployment**: Containerized serverless deployment with auto-scaling

## üöÄ Quick Start

### 1. Clone & Install
```bash
git clone https://github.com/MapMakeronline/Universe-MapMaker.online.git
cd Universe-MapMaker.online
npm install
```

### 2. Get Mapbox Token
1. Sign up at [mapbox.com](https://account.mapbox.com/auth/signup/)
2. Go to [Access Tokens](https://account.mapbox.com/access-tokens/)
3. Copy your **Default Public Token** (starts with `pk.`)

### 3. Environment Setup
Create `.env.local`:
```env
NEXT_PUBLIC_MAPBOX_TOKEN=pk.eyJ1IjoieW91cl91c2VybmFtZSIsImEiOiJjbGZxZXF3MjAwMDExM29zN3...
```

### 4. Run Development
```bash
npm run dev
```

Open [http://localhost:3000](http://localhost:3000)

## üîß Development

### Scripts
```bash
npm run dev      # Development server
npm run build    # Production build
npm run start    # Start production server
npm run lint     # Code linting
```

### Core Component
The main map is implemented in `app/page.tsx`:

```tsx
'use client';
import { useEffect, useRef, useState } from 'react';
import mapboxgl from 'mapbox-gl';

export default function MapPage() {
  // Dynamic token loading from API route
  const initializeMap = async () => {
    const response = await fetch('/api/mapbox/token');
    const { token } = await response.json();
    mapboxgl.accessToken = token;

    // Initialize map...
  };
}
```

### API Route
Token security is handled via `/api/mapbox/token/route.ts`:
```typescript
export async function GET() {
  const token = process.env.NEXT_PUBLIC_MAPBOX_TOKEN;
  return NextResponse.json({ token });
}
```

## üåê Deployment

### Google Cloud Run
The app is configured for automatic deployment to Google Cloud Run:

1. **Build**: Docker multi-stage build
2. **Registry**: Artifact Registry in `europe-central2`
3. **Deploy**: Cloud Run service with environment variables
4. **Region**: All resources in `europe-central2` for consistency

### Deploy Commands
```bash
# Build and deploy
gcloud builds submit --region=europe-central2 --config=cloudbuild.yaml --substitutions=COMMIT_SHA=$(git rev-parse HEAD)

# Check deployment
gcloud run services describe universe-mapmaker --region=europe-central2
```

## üì¶ Dependencies

### Production Dependencies
```json
{
  "@emotion/react": "^11.14.0",
  "@emotion/styled": "^11.14.1",
  "@mui/material": "^7.3.2",
  "mapbox-gl": "^3.0.0",
  "next": "^15.5.4",
  "react": "^19",
  "react-dom": "^19"
}
```

### Key Features of Dependencies
- **Next.js 15.5.4** - Latest App Router with server components
- **React 19** - Latest React with concurrent features
- **Mapbox GL 3.0** - Latest Mapbox with WebGL2 support
- **Material-UI 7.3** - Modern design system
- **TypeScript 5** - Full type safety

## üîß Configuration

### Map Settings
Default map configuration in `app/page.tsx`:
```typescript
const [lng, setLng] = useState(19.9449799);  // Krak√≥w longitude
const [lat, setLat] = useState(50.0646501);  // Krak√≥w latitude
const [zoom, setZoom] = useState(12);        // Zoom level

// Map style
style: 'mapbox://styles/mapbox/streets-v12'
```

### Environment Variables
- `NEXT_PUBLIC_MAPBOX_TOKEN` - Mapbox access token
- `NODE_ENV` - Environment (production/development)
- `NEXT_TELEMETRY_DISABLED` - Disable Next.js telemetry

## üêõ Troubleshooting

### Common Issues

**Map not loading**
- Check browser console for errors
- Verify Mapbox token starts with `pk.`
- Test API endpoint: `/api/mapbox/token`

**Build failures**
- Clear `.next` folder: `rm -rf .next`
- Reinstall dependencies: `rm -rf node_modules && npm install`

**Production token issues**
- Tokens are loaded via API route at runtime
- No build-time embedding needed
- Check Cloud Run environment variables

### Debug Info
The app displays real-time debug information:
- **Token Status**: ‚è≥ (loading) ‚Üí ‚úÖ (success) ‚Üí ‚ùå (error)
- **Coordinates**: Live latitude/longitude
- **Zoom Level**: Current map zoom

## üöÄ Performance

### Bundle Size Optimization
- Removed unused dependencies (Redux, Leaflet, DnD Kit, etc.)
- Direct Mapbox integration without abstractions
- Minimal Material-UI usage
- Tree shaking enabled

### Production Optimizations
- Docker multi-stage builds
- Next.js standalone output
- Proper caching headers
- Lazy loading and code splitting

## üìÑ License

MIT License - see [LICENSE](LICENSE) file.

## ü§ù Contributing

1. Fork the repository
2. Create feature branch: `git checkout -b feature/amazing-feature`
3. Commit changes: `git commit -m 'Add amazing feature'`
4. Push to branch: `git push origin feature/amazing-feature`
5. Open Pull Request

## üîÑ How It All Works Together

### Application Flow

**1. User Opens Application:**
```
User ‚Üí https://universe-mapmaker.app
    ‚Üì
app/page.tsx (home page)
    ‚Üì
<MapContainer /> (map component)
    ‚Üì
Mapbox GL JS initialization
    ‚Üì
Map renders with default view (Poland)
```

**2. User Clicks "Add Layer":**
```
Click ‚Üí LeftPanel.tsx
    ‚Üì
dispatch(addLayer(...)) (Redux action)
    ‚Üì
store/slices/layersSlice.ts
    ‚Üì
State updates
    ‚Üì
LeftPanel.tsx re-renders with new layer
    ‚Üì
MapContainer.tsx detects layer change
    ‚Üì
New layer appears on map
```

**3. Build & Deployment Process:**
```
npm run build
    ‚Üì
Next.js compiles TypeScript ‚Üí JavaScript
    ‚Üì
Creates .next/ folder with optimized bundles
    ‚Üì
Docker packages application + dependencies
    ‚Üì
Image pushed to Artifact Registry
    ‚Üì
Cloud Run deploys new container
    ‚Üì
Application available at production URL
```

### Data Flow Diagram

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   User UI   ‚îÇ
‚îÇ  (Browser)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Interactions
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Components    ‚îÇ  ‚Üê React components
‚îÇ  (LeftPanel,    ‚îÇ    render UI
‚îÇ   MapContainer) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ dispatch(action)
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Redux Store    ‚îÇ  ‚Üê Central state
‚îÇ  (layers, map,  ‚îÇ    management
‚îÇ   drawing)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ state updates
         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Mapbox GL JS   ‚îÇ  ‚Üê Map rendering
‚îÇ  (map instance) ‚îÇ    engine
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### File Editing Guide

| To Change... | Edit File... | Description |
|--------------|-------------|-------------|
| üé® **Left Panel UI** | `src/components/panels/LeftPanel.tsx` | Layer tree, properties panel, basemap selector |
| üó∫Ô∏è **Map Behavior** | `src/components/map/MapContainer.tsx` | Map initialization, interactions, layer rendering |
| üõ†Ô∏è **Right Toolbar** | `src/components/panels/RightToolbar.tsx` | Tool buttons, fullscreen, settings |
| üíæ **Layer State** | `src/store/slices/layersSlice.ts` | Layer list, visibility, properties logic |
| üíæ **Map State** | `src/store/slices/mapSlice.ts` | Zoom, center, style, viewport |
| üîë **Mapbox Config** | `src/lib/mapbox/config.ts` | API tokens, default settings |
| üé® **Theme Colors** | `src/lib/theme.ts` | Color palette, typography |
| üì¶ **Dependencies** | `package.json` | Add/remove libraries |
| ‚òÅÔ∏è **Cloud Deployment** | `cloudbuild.yaml` | Build steps, environment variables |
| üñ•Ô∏è **Production Server** | `server.js` | Server configuration |

### Common Development Tasks

**Adding a New Component:**
1. Create file in `src/components/[category]/NewComponent.tsx`
2. Export component: `export default function NewComponent() { ... }`
3. Import in parent: `import NewComponent from '@/components/[category]/NewComponent'`
4. Use in JSX: `<NewComponent />`

**Adding State Management:**
1. Create slice in `src/store/slices/newSlice.ts`
2. Define initial state and reducers
3. Add slice to store in `src/store/store.ts`
4. Use in component: `const data = useAppSelector(state => state.new.data)`

**Adding a New Library:**
1. Install: `npm install library-name`
2. Import in component: `import { Feature } from 'library-name'`
3. TypeScript types: `npm install -D @types/library-name` (if available)

**Deploying Changes:**
1. Commit code: `git add . && git commit -m "Description"`
2. Push to main: `git push origin main`
3. Automatic deployment triggers via Cloud Build
4. Monitor: Check Cloud Run console for status

## üí° Frequently Asked Questions

**Q: What's the difference between `.tsx` and `.ts` files?**
- `.ts` = Regular TypeScript (logic, functions, utilities)
- `.tsx` = TypeScript + JSX (React components with HTML-like syntax)

**Q: What does `import` do?**
```typescript
import { Button } from '@mui/material'
// Imports the Button component from Material-UI library
```

**Q: What does `export` do?**
```typescript
export default function MyComponent() { ... }
// Makes this component available to other files
```

**Q: Why use `@/` in imports?**
```typescript
import Component from '@/components/Component'
// '@/' is an alias for 'src/' directory (cleaner imports)
```

**Q: How does TypeScript help?**
```typescript
interface Layer {
  id: string
  name: string
  visible: boolean
}
// TypeScript checks that you use the correct types
// Catches errors before runtime!
```

**Q: What is Redux state?**
- Redux stores application data that needs to be shared between components
- Like a "memory" for your app that components can read and update
- Changes to state automatically trigger UI re-renders

**Q: How does scale-to-zero work?**
- After ~15 minutes of no traffic, Cloud Run stops the container
- You don't pay for idle time (cost = $0)
- Next request triggers "cold start" (2-5 seconds to restart)
- Subsequent requests are instant

## üîê Backend API Integration

### Authentication System

The application integrates with a Django REST API backend for user authentication and data management.

**Base API URL:** Configure in your environment variables

#### Available Endpoints

##### 1. User Registration
```
POST /auth/register
```

**Request Body:**
```json
{
  "username": "jan_kowalski",
  "email": "jan.kowalski@example.com",
  "password": "bezpieczne_haslo123",
  "password_confirm": "bezpieczne_haslo123",
  "first_name": "Jan",
  "last_name": "Kowalski"
}
```

**Response (201 Created):**
```json
{
  "token": "9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b",
  "user": {
    "id": 42,
    "username": "jan_kowalski",
    "email": "jan.kowalski@example.com",
    "first_name": "Jan",
    "last_name": "Kowalski"
  }
}
```

**What happens during registration:**
- Creates user account with validation
- Generates dedicated PostgreSQL database user with secure 20-character password
- Sets up database permissions (LOGIN, NOSUPERUSER, INHERIT, etc.)
- Returns authentication token
- Sends welcome email asynchronously

##### 2. User Login
```
POST /auth/login
```

**Request Body:**
```json
{
  "username": "jan_kowalski",
  "password": "bezpieczne_haslo123"
}
```

**Response (200 OK):**
```json
{
  "token": "9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b",
  "user": {
    "id": 42,
    "username": "jan_kowalski",
    "email": "jan.kowalski@example.com",
    "first_name": "Jan",
    "last_name": "Kowalski",
    "address": "ul. G≈Ç√≥wna 123",
    "city": "Warszawa",
    "zip_code": "00-001",
    "nip": "1234567890",
    "company_name": "Firma ABC",
    "theme": "dark"
  }
}
```

##### 3. User Logout
```
POST /auth/logout
Authorization: Token 9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b
```

**Response (200 OK):**
```json
{
  "message": "Logged out successfully"
}
```

##### 4. Get User Profile
```
GET /auth/profile
Authorization: Token 9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b
```

**Response (200 OK):**
```json
{
  "id": 42,
  "username": "jan_kowalski",
  "email": "jan.kowalski@example.com",
  "first_name": "Jan",
  "last_name": "Kowalski",
  "address": "ul. G≈Ç√≥wna 123",
  "city": "Warszawa",
  "zip_code": "00-001",
  "nip": "1234567890",
  "company_name": "Firma ABC",
  "theme": "dark"
}
```

### Authentication Flow

**Token-based authentication:**
1. User registers or logs in ‚Üí receives token
2. Store token in localStorage/sessionStorage
3. Include token in all authenticated requests:
   ```
   Authorization: Token {your_token}
   ```

**Frontend Integration Example:**
```typescript
// Login
const response = await fetch(`${API_URL}/auth/login`, {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ username, password })
});
const { token, user } = await response.json();
localStorage.setItem('authToken', token);

// Authenticated Request
const profile = await fetch(`${API_URL}/auth/profile`, {
  headers: {
    'Authorization': `Token ${localStorage.getItem('authToken')}`,
    'Content-Type': 'application/json'
  }
});
```

### Security Features

**Database Isolation:**
- Each user gets a dedicated PostgreSQL user account
- Database login format: `{email_prefix}_{timestamp}` (e.g., `jan_kowalski_123456`)
- Auto-generated secure 20-character passwords
- Restricted permissions (no SUPERUSER, CREATEDB, or CREATEROLE)

**Password Security:**
- Passwords hashed using Django's PBKDF2 with SHA256
- Password confirmation required during registration
- Atomic transactions ensure database consistency

**Token Management:**
- Tokens are permanent until logout
- Tokens invalidated on logout
- Consider implementing rate limiting for production

### Error Codes

| Code | Meaning |
|------|---------|
| 200 | OK - Request successful |
| 201 | Created - User registered successfully |
| 400 | Bad Request - Invalid input (e.g., passwords don't match) |
| 401 | Unauthorized - Invalid token or missing authorization |
| 500 | Internal Server Error - Database or server issue |

### User Profile Fields

| Field | Type | Description |
|-------|------|-------------|
| `id` | integer | Unique user ID |
| `username` | string | Username (unique) |
| `email` | string | Email address |
| `first_name` | string | First name |
| `last_name` | string | Last name |
| `address` | string | Street address (optional) |
| `city` | string | City (optional) |
| `zip_code` | string | Postal code (optional) |
| `nip` | string | Tax ID/NIP (optional) |
| `company_name` | string | Company name (optional) |
| `theme` | string | UI theme preference (optional) |

## üÜò Support

- **Issues**: [GitHub Issues](https://github.com/MapMakeronline/Universe-MapMaker.online/issues)
- **Mapbox Documentation**: [docs.mapbox.com](https://docs.mapbox.com/)
- **Next.js Documentation**: [nextjs.org/docs](https://nextjs.org/docs)
- **Material-UI Docs**: [mui.com](https://mui.com/)
- **Redux Toolkit Docs**: [redux-toolkit.js.org](https://redux-toolkit.js.org/)

---

**Built with** ‚ù§Ô∏è using **Mapbox GL JS** + **Next.js 15** + **Google Cloud Run**

*Deployed at: [universe-mapmaker-vs4lfmh3ma-lm.a.run.app](https://universe-mapmaker-vs4lfmh3ma-lm.a.run.app)*